# C03 Zero Trust Networks

**æ‰€å±å­é¢†åŸŸ**: [B08_Network_Stack](../README.md)  
**åˆ›å»ºæ—¥æœŸ**: 2026-01-30  
**æœ€åæ›´æ–°**: 2026-01-30

## ğŸ“‹ ä¸»é¢˜å®šä½

é›¶ä¿¡ä»»ç½‘ç»œï¼ˆZero Trust Networkï¼‰æ˜¯ä¸€ç§å…¨æ–°çš„ç½‘ç»œå®‰å…¨æ¶æ„ç†å¿µï¼Œå…¶æ ¸å¿ƒåŸåˆ™æ˜¯"æ°¸ä¸ä¿¡ä»»ï¼Œå§‹ç»ˆéªŒè¯"ã€‚ä¸ä¼ ç»ŸåŸºäºè¾¹ç•Œçš„å®‰å…¨æ¨¡å‹ä¸åŒï¼Œé›¶ä¿¡ä»»å‡è®¾ç½‘ç»œå†…å¤–éƒ½å­˜åœ¨å¨èƒï¼Œè¦æ±‚å¯¹æ¯ä¸ªè®¿é—®è¯·æ±‚è¿›è¡Œä¸¥æ ¼çš„èº«ä»½éªŒè¯ã€æˆæƒå’ŒåŠ å¯†ï¼Œæ— è®ºè¯·æ±‚æ¥è‡ªä½•å¤„ã€‚

é›¶ä¿¡ä»»æ¶æ„ç”±Forrester Researchåœ¨2010å¹´é¦–æ¬¡æå‡ºï¼Œéšç€äº‘è®¡ç®—ã€ç§»åŠ¨åŠå…¬å’Œç‰©è”ç½‘çš„æ™®åŠï¼Œè¿™ä¸€ç†å¿µå·²æˆä¸ºä¼ä¸šç½‘ç»œå®‰å…¨è½¬å‹çš„æ ¸å¿ƒæˆ˜ç•¥ã€‚Googleçš„BeyondCorpé¡¹ç›®æ˜¯æˆåŠŸå®æ–½é›¶ä¿¡ä»»æ¶æ„çš„å…¸å‹æ¡ˆä¾‹ï¼Œè¯æ˜äº†åœ¨ä¸ä¾èµ–VPNçš„æƒ…å†µä¸‹å®ç°å®‰å…¨è¿œç¨‹è®¿é—®çš„å¯è¡Œæ€§ã€‚

æœ¬ä¸“é¢˜ç³»ç»Ÿæ¢è®¨é›¶ä¿¡ä»»ç½‘ç»œçš„æ ¸å¿ƒåŸåˆ™ã€æ¶æ„ç»„ä»¶ã€å®ç°æŠ€æœ¯ä»¥åŠè½åœ°å®è·µï¼Œå¸®åŠ©ç»„ç»‡æ„å»ºæ›´å®‰å…¨ã€æ›´çµæ´»çš„ç½‘ç»œå®‰å…¨ä½“ç³»ã€‚

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ

### é›¶ä¿¡ä»»æ ¸å¿ƒåŸåˆ™

| åŸåˆ™ | è¯´æ˜ | å®è·µè¦ç‚¹ |
|-----|------|---------|
| **æ°¸ä¸ä¿¡ä»»ï¼Œå§‹ç»ˆéªŒè¯** | ä¸åŸºäºç½‘ç»œä½ç½®é»˜è®¤ä¿¡ä»» | æ‰€æœ‰è®¿é—®éƒ½éœ€è¦è®¤è¯ |
| **æœ€å°æƒé™è®¿é—®** | åªæˆäºˆå¿…è¦çš„æœ€å°æƒé™ | åŠ¨æ€æƒé™æ§åˆ¶ï¼ŒæŒç»­è¯„ä¼° |
| **å‡è®¾å·²æ”»ç ´** | å‡è®¾æ”»å‡»è€…å·²åœ¨ç½‘ç»œå†…éƒ¨ | å¾®åˆ†æ®µã€æŒç»­ç›‘æ§ |
| **æ˜¾å¼éªŒè¯** | åŸºäºæ‰€æœ‰å¯ç”¨æ•°æ®ç‚¹éªŒè¯ | è®¾å¤‡çŠ¶æ€ã€ç”¨æˆ·èº«ä»½ã€è¡Œä¸ºåˆ†æ |

### é›¶ä¿¡ä»»æ¶æ„ç»„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         é›¶ä¿¡ä»»æ¶æ„å…¨æ™¯                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     ç”¨æˆ·/è®¾å¤‡èº«ä»½å±‚                               â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚   ç”¨æˆ·è®¤è¯   â”‚  â”‚   è®¾å¤‡è®¤è¯   â”‚  â”‚      è¡Œä¸ºåˆ†æ           â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  (IdP/MFA)  â”‚  â”‚  (è¯ä¹¦/TPM) â”‚  â”‚  - å¼‚å¸¸è¡Œä¸ºæ£€æµ‹         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚             â”‚  â”‚             â”‚  â”‚  - é£é™©è¯„åˆ†             â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚   â”‚
â”‚  â”‚                              â”‚                                  â”‚   â”‚
â”‚  â”‚                              â–¼                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚              ç­–ç•¥å†³ç­–ç‚¹ (Policy Decision Point, PDP)       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ ç­–ç•¥å¼•æ“ - è¯„ä¼°è®¿é—®è¯·æ±‚ï¼Œè®¡ç®—é£é™©è¯„åˆ†                    â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ ä¿¡ä»»å¼•æ“ - åŸºäºå†å²è¡Œä¸ºå»ºç«‹ä¿¡ä»»åŸºçº¿                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ ç­–ç•¥ç®¡ç† - å®šä¹‰å’Œæ‰§è¡Œè®¿é—®ç­–ç•¥                           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                          â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                              â”‚                                  â”‚   â”‚
â”‚  â”‚                              â–¼                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    ç­–ç•¥æ‰§è¡Œç‚¹ (Policy Enforcement Point, PEP)      â”‚   â”‚
â”‚  â”‚                              â”‚                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚                    å®‰å…¨è®¿é—®æœåŠ¡è¾¹ç¼˜ (SASE)                    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                              â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  SDP/IAP    â”‚  â”‚  SWG/é˜²ç«å¢™  â”‚  â”‚      CASB           â”‚ â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ (è½¯ä»¶å®šä¹‰è¾¹ç•Œ)â”‚  â”‚            â”‚  â”‚ (äº‘è®¿é—®å®‰å…¨ä»£ç†)      â”‚ â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                              â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                              â”‚                                   â”‚   â”‚
â”‚  â”‚                              â–¼                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚                    èµ„æºå±‚                                  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                          â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  SaaSåº”ç”¨  â”‚  â”‚ ç§æœ‰åº”ç”¨  â”‚  â”‚ äº‘å¹³å°    â”‚  â”‚ ç½‘ç»œèµ„æº  â”‚ â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ (Salesforceâ”‚  â”‚ (å†…éƒ¨ç³»ç»Ÿ) â”‚  â”‚ (AWS/Azureâ”‚  â”‚ (æ•°æ®åº“)  â”‚ â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  Office365)â”‚  â”‚          â”‚  â”‚  GCP)     â”‚  â”‚          â”‚ â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                          â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  ä¿æŠ¤æœºåˆ¶:                                                 â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ å¾®åˆ†æ®µ - ç»†ç²’åº¦ç½‘ç»œéš”ç¦»                                  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ åŠ å¯†ä¼ è¾“ - mTLS/WireGuard                               â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ æŒç»­éªŒè¯ - ä¼šè¯ç”Ÿå‘½å‘¨æœŸç®¡ç†                               â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                          â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  èº«ä»½å’Œè®¿é—®ç®¡ç† (IAM)                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ ç»Ÿä¸€èº«ä»½æº (IdP) - Okta/Azure AD/Keycloak                    â”‚   â”‚
â”‚  â”‚  â€¢ å¤šå› ç´ è®¤è¯ (MFA) - TOTP/WebAuthn/ç”Ÿç‰©è¯†åˆ«                     â”‚   â”‚
â”‚  â”‚  â€¢ æƒé™ç®¡ç† - RBAC/ABAC/åŠ¨æ€æƒé™                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è½¯ä»¶å®šä¹‰è¾¹ç•Œï¼ˆSDPï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      è½¯ä»¶å®šä¹‰è¾¹ç•Œï¼ˆSDPï¼‰æ¶æ„                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  SDPæ ¸å¿ƒæ¦‚å¿µ: å…ˆè®¤è¯ï¼Œåè¿æ¥ (Authenticate before Connect)               â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      SDPæ§åˆ¶å™¨ (SDP Controller)                   â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚                    ç­–ç•¥ç®¡ç†                               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ ç”¨æˆ·/è®¾å¤‡è®¤è¯                                        â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ è®¿é—®ç­–ç•¥é…ç½®                                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€ å®æ—¶ç­–ç•¥æ›´æ–°                                         â”‚   â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
â”‚  â”‚  â”‚                    SPAå¤„ç† (Single Packet Authorization)  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ éªŒè¯SPAå•åŒ…                                          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ é˜²æ­¢ç«¯å£æ‰«æ                                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€ åŠ¨æ€é˜²ç«å¢™è§„åˆ™                                        â”‚   â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
â”‚  â”‚  â”‚                    ç½‘å…³ç®¡ç†                               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ ç”¨æˆ·-ç½‘å…³æ˜ å°„                                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ ç½‘å…³å¥åº·æ£€æŸ¥                                          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€ è´Ÿè½½å‡è¡¡                                              â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â–²                                          â”‚
â”‚                              â”‚ SPA (Single Packet Authorization)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â”‚   å®¢æˆ·ç«¯å‘èµ·SPAè¯·æ±‚:                                                 â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚   â”‚  åŠ å¯†æ•°æ®åŒ…åŒ…å«: ç”¨æˆ·å‡­è¯ + æ—¶é—´æˆ³ + ç›®æ ‡æœåŠ¡ + HMAC        â”‚  â”‚  â”‚
â”‚  â”‚   â”‚  é˜²ç«å¢™é»˜è®¤DROPæ‰€æœ‰åŒ…ï¼Œåªæœ‰éªŒè¯SPAåæ‰å…è®¸è¿æ¥              â”‚  â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                          â”‚
â”‚                              â–¼ (è®¤è¯é€šè¿‡å)                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    SDPç½‘å…³ (SDP Gateway)                          â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚                    éš§é“ç»ˆç«¯                               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ TLS/mTLSéš§é“                                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ WireGuard/IPsec                                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€ DTLS (ç§»åŠ¨åœºæ™¯)                                       â”‚   â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
â”‚  â”‚  â”‚                    è®¿é—®ä»£ç†                               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ L4ä»£ç† (TCP/UDP)                                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ L7ä»£ç† (HTTP/HTTPS/WebSocket)                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€ åè®®æ£€æŸ¥                                               â”‚   â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
â”‚  â”‚  â”‚                    å®‰å…¨æ§åˆ¶                               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ DLP (æ•°æ®é˜²æ³„æ¼)                                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€ å†…å®¹è¿‡æ»¤                                               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€ ä¼šè¯å®¡è®¡                                               â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â–²                                          â”‚
â”‚                              â”‚ åŠ å¯†éš§é“                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    SDPå®¢æˆ·ç«¯ (SDP Client)                          â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ è®¾å¤‡è¯ä¹¦ç®¡ç†                                             â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ SPAåŒ…ç”Ÿæˆå’Œå‘é€                                          â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ éš§é“å»ºç«‹å’Œç»´æŠ¤                                           â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ åº”ç”¨å±‚ä»£ç†                                               â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â”‚  æ”¯æŒå¹³å°: Windows / macOS / Linux / iOS / Android                 â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å¾®åˆ†æ®µï¼ˆMicro-segmentationï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å¾®åˆ†æ®µæ¶æ„ç¤ºä¾‹                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  ä¼ ç»Ÿç½‘ç»œåˆ†æ®µ vs å¾®åˆ†æ®µ:                                                  â”‚
â”‚                                                                         â”‚
â”‚  ä¼ ç»Ÿåˆ†æ®µ (VLAN/å­ç½‘):                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚  â”‚ VLAN 10  â”‚ VLAN 20  â”‚ VLAN 30  â”‚ VLAN 40  â”‚  â† ç²—ç²’åº¦ï¼ŒåŸºäºå­ç½‘      â”‚
â”‚  â”‚  Webå±‚   â”‚  Appå±‚   â”‚  DBå±‚    â”‚  ç®¡ç†    â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚       é˜²ç«å¢™è§„åˆ™: å…è®¸VLAN10 â†’ VLAN20                                    â”‚
â”‚                  å…è®¸VLAN20 â†’ VLAN30                                    â”‚
â”‚                                                                         â”‚
â”‚  å¾®åˆ†æ®µ (å·¥ä½œè´Ÿè½½çº§):                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  å·¥ä½œè´Ÿè½½A        å·¥ä½œè´Ÿè½½B        å·¥ä½œè´Ÿè½½C       å·¥ä½œè´Ÿè½½D      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚Web-01  â”‚      â”‚App-01  â”‚      â”‚App-02  â”‚      â”‚DB-01   â”‚    â”‚   â”‚
â”‚  â”‚  â”‚æ ‡ç­¾:   â”‚      â”‚æ ‡ç­¾:   â”‚      â”‚æ ‡ç­¾:   â”‚      â”‚æ ‡ç­¾:   â”‚    â”‚   â”‚
â”‚  â”‚  â”‚env=prodâ”‚      â”‚env=prodâ”‚      â”‚env=dev â”‚      â”‚env=prodâ”‚    â”‚   â”‚
â”‚  â”‚  â”‚tier=webâ”‚      â”‚tier=appâ”‚      â”‚tier=appâ”‚      â”‚tier=db â”‚    â”‚   â”‚
â”‚  â”‚  â”‚app=shopâ”‚      â”‚app=shopâ”‚      â”‚app=testâ”‚      â”‚app=shopâ”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚       â”‚               â”‚               â”‚               â”‚        â”‚   â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚        â”‚   â”‚
â”‚  â”‚       å…è®¸ (env=prod, tier=web â†’ tier=app)            â”‚        â”‚   â”‚
â”‚  â”‚                       â”‚                               â”‚        â”‚   â”‚
â”‚  â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚   â”‚
â”‚  â”‚                       å…è®¸ (env=prod, tier=app â†’ tier=db)       â”‚   â”‚
â”‚  â”‚                                                       â”‚        â”‚   â”‚
â”‚  â”‚                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â”‚
â”‚  â”‚                               â”‚ æ‹’ç» (env=dev â†’ env=prod)       â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  æ ‡ç­¾é©±åŠ¨çš„ç­–ç•¥:                                                         â”‚
â”‚  â€¢ å…è®¸: tier=web AND env=prod â†’ tier=app AND env=prod                 â”‚
â”‚  â€¢ æ‹’ç»: tier=app AND env=dev â†’ tier=db                                 â”‚
â”‚  â€¢ é»˜è®¤: deny-all                                                         â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ æŠ€æœ¯å®è·µ

### é›¶ä¿¡ä»»ç½‘ç»œéƒ¨ç½²

**1. åŸºäºWireGuardçš„é›¶ä¿¡ä»»ç½‘ç»œ**

```bash
#!/bin/bash
# WireGuardé›¶ä¿¡ä»»ç½‘ç»œéƒ¨ç½²è„šæœ¬
# å®ç°åŸºäºèº«ä»½çš„ç½‘æ ¼ç½‘ç»œ

set -e

ROLE=${1:-"server"}  # server/client
WG_INTERFACE=${WG_INTERFACE:-"wg0"}
WG_PORT=${WG_PORT:-"51820"}

echo "=== WireGuardé›¶ä¿¡ä»»ç½‘ç»œéƒ¨ç½² ==="
echo "è§’è‰²: $ROLE"
echo ""

# å®‰è£…WireGuard
install_wireguard() {
    if ! command -v wg &> /dev/null; then
        echo "å®‰è£…WireGuard..."
        apt-get update
        apt-get install -y wireguard wireguard-tools
    fi
}

# ç”Ÿæˆå¯†é’¥å¯¹
generate_keys() {
    local private_key=$(wg genkey)
    local public_key=$(echo "$private_key" | wg pubkey)
    echo "$private_key $public_key"
}

# é…ç½®æœåŠ¡å™¨
setup_server() {
    echo "é…ç½®WireGuardæœåŠ¡å™¨..."
    
    # ç”ŸæˆæœåŠ¡å™¨å¯†é’¥
    read -r SERVER_PRIVATE SERVER_PUBLIC <<< $(generate_keys)
    
    # åˆ›å»ºé…ç½®æ–‡ä»¶
    cat > /etc/wireguard/${WG_INTERFACE}.conf << EOF
[Interface]
PrivateKey = $SERVER_PRIVATE
Address = 10.200.200.1/24
ListenPort = $WG_PORT
PostUp = iptables -A FORWARD -i $WG_INTERFACE -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
PostDown = iptables -D FORWARD -i $WG_INTERFACE -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE

# å®¢æˆ·ç«¯é…ç½® (ç¤ºä¾‹)
# [Peer]
# PublicKey = <å®¢æˆ·ç«¯å…¬é’¥>
# AllowedIPs = 10.200.200.2/32
# PersistentKeepalive = 25
EOF
    
    chmod 600 /etc/wireguard/${WG_INTERFACE}.conf
    
    # å¯ç”¨IPè½¬å‘
    echo "net.ipv4.ip_forward=1" >> /etc/sysctl.conf
    sysctl -p
    
    # å¯åŠ¨æœåŠ¡
    systemctl enable wg-quick@$WG_INTERFACE
    systemctl start wg-quick@$WG_INTERFACE
    
    echo ""
    echo "=== æœåŠ¡å™¨å…¬é’¥ (åˆ†å‘ç»™å®¢æˆ·ç«¯) ==="
    echo "$SERVER_PUBLIC"
    echo ""
    echo "æœåŠ¡å™¨IP: 10.200.200.1"
}

# é…ç½®å®¢æˆ·ç«¯
setup_client() {
    local server_public=$2
    local server_endpoint=$3
    
    echo "é…ç½®WireGuardå®¢æˆ·ç«¯..."
    
    # ç”Ÿæˆå®¢æˆ·ç«¯å¯†é’¥
    read -r CLIENT_PRIVATE CLIENT_PUBLIC <<< $(generate_keys)
    
    # åˆ†é…å®¢æˆ·ç«¯IP (ç¤ºä¾‹)
    local client_ip="10.200.200.2/24"
    
    cat > /etc/wireguard/${WG_INTERFACE}.conf << EOF
[Interface]
PrivateKey = $CLIENT_PRIVATE
Address = $client_ip
DNS = 1.1.1.1

[Peer]
PublicKey = $server_public
AllowedIPs = 0.0.0.0/0  # æ‰€æœ‰æµé‡é€šè¿‡éš§é“
Endpoint = $server_endpoint:$WG_PORT
PersistentKeepalive = 25
EOF
    
    chmod 600 /etc/wireguard/${WG_INTERFACE}.conf
    
    echo ""
    echo "=== å®¢æˆ·ç«¯å…¬é’¥ (æ·»åŠ åˆ°æœåŠ¡å™¨) ==="
    echo "$CLIENT_PUBLIC"
    echo ""
}

# æ·»åŠ å¯¹ç­‰èŠ‚ç‚¹ (æœåŠ¡å™¨ä¸Šæ‰§è¡Œ)
add_peer() {
    local peer_public=$2
    local peer_ip=$3
    
    echo "æ·»åŠ å¯¹ç­‰èŠ‚ç‚¹..."
    
    # åŠ¨æ€æ·»åŠ peer
    wg set $WG_INTERFACE peer $peer_public allowed-ips $peer_ip
    
    # æŒä¹…åŒ–åˆ°é…ç½®æ–‡ä»¶
    cat >> /etc/wireguard/${WG_INTERFACE}.conf << EOF

[Peer]
PublicKey = $peer_public
AllowedIPs = $peer_ip
PersistentKeepalive = 25
EOF
    
    echo "å¯¹ç­‰èŠ‚ç‚¹å·²æ·»åŠ : $peer_ip"
}

# æ˜¾ç¤ºçŠ¶æ€
show_status() {
    echo "=== WireGuardçŠ¶æ€ ==="
    wg show $WG_INTERFACE
    
    echo ""
    echo "=== æ¥å£ä¿¡æ¯ ==="
    ip addr show $WG_INTERFACE 2>/dev/null || echo "æ¥å£æœªå¯åŠ¨"
}

# ä¸»é€»è¾‘
case "$ROLE" in
    server)
        install_wireguard
        setup_server
        show_status
        ;;
    client)
        if [ -z "$2" ] || [ -z "$3" ]; then
            echo "ç”¨æ³•: $0 client <æœåŠ¡å™¨å…¬é’¥> <æœåŠ¡å™¨åœ°å€:ç«¯å£>"
            exit 1
        fi
        install_wireguard
        setup_client "$@"
        ;;
    add-peer)
        if [ -z "$2" ] || [ -z "$3" ]; then
            echo "ç”¨æ³•: $0 add-peer <peerå…¬é’¥> <peer IP>"
            exit 1
        fi
        add_peer "$@"
        ;;
    status)
        show_status
        ;;
    *)
        echo "ç”¨æ³•: $0 <server|client|add-peer|status>"
        ;;
esac
```

**2. åŸºäºSPIFFE/SPIREçš„èº«ä»½ç®¡ç†**

```yaml
# SPIREæœåŠ¡å™¨é…ç½®ç¤ºä¾‹
# server.conf
server {
    bind_address = "0.0.0.0"
    bind_port = "8081"
    trust_domain = "example.org"
    
    data_dir = "/opt/spire/data/server"
    log_level = "DEBUG"
    
    # CAé…ç½®
    ca_key_type = "ec-p256"
    ca_ttl = "24h"
    
    # JWTç­¾åå¯†é’¥
    jwt_issuer = "https://spire.example.org"
}

# èŠ‚ç‚¹è®¤è¯ (Node Attestation)
plugins {
    NodeAttestor "join_token" {
        plugin_data {
            # ç®€å•tokenè®¤è¯ (æµ‹è¯•ç”¨)
        }
    }
    
    NodeAttestor "aws_iid" {
        plugin_data {
            # AWSå®ä¾‹èº«ä»½è®¤è¯
        }
    }
    
    NodeAttestor "k8s_psat" {
        plugin_data {
            # Kubernetes Projected Service Account Token
            clusters = {
                "production" = {
                    service_account_allow_list = ["spire:spire-agent"]
                }
            }
        }
    }
    
    # æ•°æ®å­˜å‚¨
    DataStore "sql" {
        plugin_data {
            database_type = "sqlite3"
            connection_string = "/opt/spire/data/server/datastore.sqlite3"
        }
    }
    
    # KeyManager
    KeyManager "disk" {
        plugin_data {
            keys_path = "/opt/spire/data/server/keys.json"
        }
    }
}
```

```yaml
# SPIRE Agenté…ç½®
# agent.conf
agent {
    data_dir = "/opt/spire/data/agent"
    log_level = "DEBUG"
    server_address = "spire-server"
    server_port = "8081"
    socket_path = "/tmp/spire-agent/public/api.sock"
    trust_bundle_path = "/opt/spire/conf/agent/bootstrap.crt"
    trust_domain = "example.org"
}

plugins {
    NodeAttestor "join_token" {
        plugin_data {}
    }
    
    WorkloadAttestor "unix" {
        plugin_data {}
    }
    
    WorkloadAttestor "k8s" {
        plugin_data {
            # Kubernetes workloadè®¤è¯
            kubelet_read_only_port = 10255
        }
    }
}
```

**3. åŸºäºIstioçš„é›¶ä¿¡ä»»æœåŠ¡ç½‘æ ¼**

```yaml
# Istioé›¶ä¿¡ä»»é…ç½®ç¤ºä¾‹
# peer-authentication.yaml
# å¯ç”¨mTLS (Workloadçº§åˆ«)

apiVersion: security.istio.io/v1beta1
kind: PeerAuthentication
metadata:
  name: default
  namespace: istio-system
spec:
  mtls:
    mode: STRICT  # å¼ºåˆ¶mTLS

---
# ç‰¹å®šå‘½åç©ºé—´å…è®¸PERMISSIVE (æ¸è¿›å¼è¿ç§»)
apiVersion: security.istio.io/v1beta1
kind: PeerAuthentication
metadata:
  name: legacy
  namespace: legacy-apps
spec:
  mtls:
    mode: PERMISSIVE  # å…è®¸æ˜æ–‡å’ŒmTLS

---
# AuthorizationPolicy - æˆæƒç­–ç•¥
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: frontend-policy
  namespace: production
spec:
  selector:
    matchLabels:
      app: frontend
  action: ALLOW
  rules:
    # å…è®¸æ¥è‡ªingress gatewayçš„æµé‡
    - from:
        - source:
            principals: ["cluster.local/ns/istio-system/sa/istio-ingressgateway"]
      to:
        - operation:
            methods: ["GET", "POST"]
            paths: ["/api/*"]

---
# æ‹’ç»æ‰€æœ‰è®¿é—® (é»˜è®¤æ‹’ç»)
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: deny-all
  namespace: production
spec:
  action: DENY

---
# å¾®æœåŠ¡é—´ç»†ç²’åº¦è®¿é—®æ§åˆ¶
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: service-to-service
  namespace: production
spec:
  selector:
    matchLabels:
      app: backend
  action: ALLOW
  rules:
    # åªå…è®¸æ¥è‡ªfrontendæœåŠ¡çš„JWT tokenè®¿é—®
    - from:
        - source:
            principals: ["cluster.local/ns/production/sa/frontend"]
      to:
        - operation:
            methods: ["GET"]
            paths: ["/data/*"]
      when:
        - key: request.auth.claims[iss]
          values: ["https://accounts.google.com"]
```

### é›¶ä¿¡ä»»å®‰å…¨ç›‘æ§

**4. å®‰å…¨äº‹ä»¶ç›‘æ§è„šæœ¬ï¼ˆPythonï¼‰**

```python
#!/usr/bin/env python3
"""
é›¶ä¿¡ä»»å®‰å…¨ç›‘æ§å·¥å…·
åˆ†æè®¿é—®æ—¥å¿—ã€æ£€æµ‹å¼‚å¸¸è¡Œä¸º
"""

import json
import re
import time
from dataclasses import dataclass
from typing import Dict, List, Set
from collections import defaultdict
import hashlib


@dataclass
class AccessEvent:
    """è®¿é—®äº‹ä»¶"""
    timestamp: float
    user_id: str
    device_id: str
    source_ip: str
    resource: str
    action: str
    result: str
    risk_score: float = 0.0


class ZeroTrustMonitor:
    """é›¶ä¿¡ä»»ç›‘æ§å™¨"""
    
    def __init__(self):
        self.user_history: Dict[str, List[AccessEvent]] = defaultdict(list)
        self.device_history: Dict[str, List[AccessEvent]] = defaultdict(list)
        self.baseline: Dict[str, Dict] = {}  # ç”¨æˆ·è¡Œä¸ºåŸºçº¿
        
    def parse_access_log(self, log_line: str) -> AccessEvent:
        """è§£æè®¿é—®æ—¥å¿—"""
        # ç¤ºä¾‹æ—¥å¿—æ ¼å¼: JSON
        try:
            data = json.loads(log_line)
            return AccessEvent(
                timestamp=data.get('timestamp', time.time()),
                user_id=data.get('user_id', 'unknown'),
                device_id=data.get('device_id', 'unknown'),
                source_ip=data.get('source_ip', 'unknown'),
                resource=data.get('resource', 'unknown'),
                action=data.get('action', 'unknown'),
                result=data.get('result', 'unknown')
            )
        except:
            return None
    
    def calculate_risk_score(self, event: AccessEvent) -> float:
        """è®¡ç®—é£é™©è¯„åˆ†"""
        risk = 0.0
        
        # 1. å¼‚å¸¸æ—¶é—´è®¿é—® (éå·¥ä½œæ—¶é—´)
        hour = time.localtime(event.timestamp).tm_hour
        if hour < 8 or hour > 20:
            risk += 0.2
        
        # 2. æ–°è®¾å¤‡
        if event.device_id not in self.device_history:
            risk += 0.3
        
        # 3. å¼‚åœ°è®¿é—® (ç®€åŒ–åˆ¤æ–­)
        user_ips = {e.source_ip for e in self.user_history.get(event.user_id, [])}
        if user_ips and event.source_ip not in user_ips:
            risk += 0.3
        
        # 4. æ•æ„Ÿèµ„æºè®¿é—®
        sensitive_resources = {'admin', 'finance', 'hr'}
        if any(r in event.resource.lower() for r in sensitive_resources):
            risk += 0.2
        
        # 5. è®¿é—®å¤±è´¥æ¬¡æ•°
        recent_failures = sum(
            1 for e in self.user_history.get(event.user_id, [])[-10:]
            if e.result == 'denied'
        )
        if recent_failures > 3:
            risk += 0.2
        
        return min(risk, 1.0)
    
    def detect_anomalies(self, event: AccessEvent) -> List[str]:
        """æ£€æµ‹å¼‚å¸¸è¡Œä¸º"""
        alerts = []
        
        # æ£€æŸ¥ Impossible Travel (ä¸å¯èƒ½æ—…è¡Œ)
        user_events = self.user_history.get(event.user_id, [])
        if len(user_events) > 0:
            last_event = user_events[-1]
            time_diff = event.timestamp - last_event.timestamp
            
            # ç®€åŒ–: å¦‚æœIPå˜åŒ–å¾ˆå¿« (å®é™…æƒ…å†µéœ€è¦åœ°ç†ä½ç½®ä¿¡æ¯)
            if (event.source_ip != last_event.source_ip and 
                time_diff < 3600):  # 1å°æ—¶å†…IPå˜åŒ–
                alerts.append(f"å¯èƒ½çš„è´¦æˆ·å…±äº«æˆ–è¢«ç›—ç”¨: IPä» {last_event.source_ip} å˜ä¸º {event.source_ip}")
        
        # æ£€æŸ¥æƒé™æå‡å°è¯•
        if event.action == 'admin_access' and 'admin' not in event.user_id:
            alerts.append(f"éç®¡ç†å‘˜ç”¨æˆ·å°è¯•ç®¡ç†å‘˜æ“ä½œ: {event.user_id}")
        
        # æ£€æŸ¥æš´åŠ›ç ´è§£
        recent_denied = [
            e for e in self.user_history.get(event.user_id, [])[-10:]
            if e.result == 'denied'
        ]
        if len(recent_denied) >= 5:
            alerts.append(f"å¤šæ¬¡è®¿é—®è¢«æ‹’ç»ï¼Œå¯èƒ½çš„æš´åŠ›ç ´è§£å°è¯•")
        
        return alerts
    
    def process_event(self, event: AccessEvent):
        """å¤„ç†è®¿é—®äº‹ä»¶"""
        # è®¡ç®—é£é™©è¯„åˆ†
        event.risk_score = self.calculate_risk_score(event)
        
        # æ£€æµ‹å¼‚å¸¸
        alerts = self.detect_anomalies(event)
        
        # å­˜å‚¨å†å²
        self.user_history[event.user_id].append(event)
        self.device_history[event.device_id].append(event)
        
        # è¾“å‡ºç»“æœ
        return {
            'event': {
                'user': event.user_id,
                'resource': event.resource,
                'action': event.action,
                'risk_score': round(event.risk_score, 2)
            },
            'alerts': alerts
        }
    
    def generate_user_baseline(self, user_id: str) -> Dict:
        """ç”Ÿæˆç”¨æˆ·è¡Œä¸ºåŸºçº¿"""
        events = self.user_history.get(user_id, [])
        if not events:
            return {}
        
        # å¸¸ç”¨IP
        common_ips = defaultdict(int)
        for e in events:
            common_ips[e.source_ip] += 1
        
        # å¸¸ç”¨æ—¶é—´
        hours = [time.localtime(e.timestamp).tm_hour for e in events]
        hour_dist = defaultdict(int)
        for h in hours:
            hour_dist[h] += 1
        
        # è®¿é—®èµ„æº
        resources = set(e.resource for e in events)
        
        baseline = {
            'user_id': user_id,
            'common_ips': dict(common_ips),
            'active_hours': dict(hour_dist),
            'known_resources': list(resources),
            'total_events': len(events)
        }
        
        self.baseline[user_id] = baseline
        return baseline


if __name__ == '__main__':
    monitor = ZeroTrustMonitor()
    
    # æ¨¡æ‹Ÿäº‹ä»¶
    test_events = [
        json.dumps({
            'timestamp': time.time(),
            'user_id': 'user1@example.com',
            'device_id': 'device-001',
            'source_ip': '192.168.1.100',
            'resource': '/api/data',
            'action': 'read',
            'result': 'success'
        }),
        json.dumps({
            'timestamp': time.time() + 60,
            'user_id': 'user1@example.com',
            'device_id': 'device-002',  # æ–°è®¾å¤‡
            'source_ip': '10.0.0.50',   # æ–°IP
            'resource': '/admin/users',
            'action': 'admin_access',
            'result': 'denied'
        })
    ]
    
    for log in test_events:
        event = monitor.parse_access_log(log)
        if event:
            result = monitor.process_event(event)
            print(json.dumps(result, indent=2))
```

## ğŸ“š èµ„æºç´¢å¼•

### é›¶ä¿¡ä»»æ¡†æ¶ä¸æ ‡å‡†

| èµ„æº | ç»„ç»‡ | è¯´æ˜ |
|-----|------|------|
| **NIST SP 800-207** | NIST | é›¶ä¿¡ä»»æ¶æ„æ ‡å‡† |
| **BeyondCorp** | Google | Googleé›¶ä¿¡ä»»å®è·µ |
| **Azure AD ZTNA** | Microsoft | Azureé›¶ä¿¡ä»»ç½‘ç»œè®¿é—® |
| **Zscaler ZPA** | Zscaler | é›¶ä¿¡ä»»ç§æœ‰è®¿é—® |

### å¼€æºé¡¹ç›®

| é¡¹ç›® | è¯´æ˜ | é“¾æ¥ |
|-----|------|------|
| **SPIFFE/SPIRE** | å·¥ä½œè´Ÿè½½èº«ä»½ | spiffe.io |
| **OpenZiti** | é›¶ä¿¡ä»»ç½‘ç»œè¦†ç›– | openziti.io |
| **Teleport** | é›¶ä¿¡ä»»è®¿é—®å¹³å° | goteleport.com |
| **Boundary** | HashiCorpé›¶ä¿¡ä»» | boundaryproject.io |

## ğŸ”— å…³è”çŸ¥è¯†

```mermaid
flowchart TB
    subgraph C03_Zero_Trust[é›¶ä¿¡ä»»ç½‘ç»œ]
        SDP[è½¯ä»¶å®šä¹‰è¾¹ç•Œ]
        IAM[èº«ä»½ç®¡ç†]
        MicroSeg[å¾®åˆ†æ®µ]
        SASE[SASEæ¶æ„]
    end
    
    subgraph B08_Network[ç½‘ç»œæ ˆ]
        C01_TCPIP[[C01 TCP/IPä¼˜åŒ–]]
        C02_SDN_NFV[[C02 SDN/NFV]]
    end
    
    subgraph B10_Cloud[äº‘å¹³å°]
        C01_Multi_Cloud[[C01 å¤šäº‘ç­–ç•¥]]
    end
    
    C03_Zero_Trust --> C01_TCPIP
    C03_Zero_Trust --> C02_SDN_NFV
    C03_Zero_Trust --> C01_Multi_Cloud
```

## ğŸ’¡ å­¦ä¹ å»ºè®®

### å…¥é—¨è·¯å¾„

1. **æ¦‚å¿µå­¦ä¹ **ï¼ˆ1-2å‘¨ï¼‰
   - ç†è§£é›¶ä¿¡ä»»æ ¸å¿ƒåŸåˆ™
   - å­¦ä¹ NIST SP 800-207
   - ç ”ç©¶Google BeyondCorp

2. **æŠ€æœ¯å®è·µ**ï¼ˆ3-4å‘¨ï¼‰
   - éƒ¨ç½²WireGuardç½‘ç»œ
   - é…ç½®SPIFFEèº«ä»½
   - å®æ–½Istioé›¶ä¿¡ä»»

3. **æ¶æ„è®¾è®¡**ï¼ˆ5-8å‘¨ï¼‰
   - è®¾è®¡SDPæ¶æ„
   - å¾®åˆ†æ®µå®æ–½
   - æŒç»­éªŒè¯ç³»ç»Ÿ

---

*æœ€åæ›´æ–°: 2026-01-30*  
*ç»´æŠ¤è€…: Infrastructure Team*
